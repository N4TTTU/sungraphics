---
import Layout from "@/layouts/Layout.astro";
import type { Servicio } from "@/assets/data/servicios";
import { servicios } from "@/assets/data/servicios";

// Rutas estáticas para prerender
export async function getStaticPaths() {
    return servicios.map((s) => ({
        params: { slug: s.slug },
        props: { servicio: s },
    }));
}

const { servicio } = Astro.props as { servicio: Servicio };

// Fallback de portada
const portada =
    servicio.imagenPrincipal ?? servicio.galeria?.[0] ?? "/img/placeholder.jpg";
---

<Layout>
    <section class="container mx-auto px-4 py-12">
        <header class="mb-8">
            <h1 class="text-3xl font-bold mb-3">{servicio.titulo}</h1>
            {
                servicio.descripcion && (
                    <p class="text-gray-600">{servicio.descripcion}</p>
                )
            }
        </header>

        {/* Portada */}
        <figure class="mb-10">
            <img
                src={portada}
                alt={`Portada de ${servicio.titulo}`}
                class="w-full max-h-[480px] object-cover rounded-xl shadow-sm"
                loading="eager"
                width="1200"
                height="800"
            />
        </figure>

        {/* Galería (si hay) */}
        {
            servicio.galeria.length > 0 && (
                <section class="mb-12">
                    <h2 class="text-2xl font-semibold mb-4">Galería</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                        {servicio.galeria.map((img: string, i: number) => (
                            <img
                                src={img}
                                alt={`${servicio.titulo} ${i + 1}`}
                                class="rounded-xl shadow-sm hover:shadow-lg transition-transform duration-300 hover:scale-105"
                                loading="lazy"
                                width="800"
                                height="600"
                            />
                        ))}
                    </div>
                </section>
            )
        }
    </section>
</Layout>
